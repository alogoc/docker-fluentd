# ianblenke/fluentd

This is a highly configurable [fluentd][2] docker image bundled with ElasticSearch, S3, and Cloudwatch plugins.

Please take a second and read through the run.sh script, as an attempt has been made to document it and make it readable.

This container uses supervisord to spawn fluentd and confd simultaneously.

Confd requires an `ETCD_IP` (host) or `ETCD_ADDR` (host:port) to be defined. If neither are found, supervisord will spawn a local etcd for confd to use.

The confd config allows the embedding of confd programmagic expressions like `{{ getenv "VARIABLE" }}`, as well as multi-host service discovery and self-healing fluentd containers communicating with elasticsearch servers.

There is a default configuration dynamically generated by the run.sh script. This will be extended to a ONELINE environment variable scheme eventually, as with [ianblenke/docker-logstash][3]

## Optional, build and run the image from source

If you prefer to build from source rather than use the [ianblenke/fluentd][1] trusted build published to the public Docker Registry, execute the following:

    $ git clone https://github.com/ianblenke/docker-fluentd.git
    $ cd docker-fluentd

If you are using Vagrant, start and provision a virtual machine using the provided Vagrantfile:

    $ vagrant up
    $ vagrant ssh
    $ cd /vagrant

From there, build and run a container using the newly created virtual machine:

    $ make build
    $ make <options> run

You can now verify the fluentd installation by visiting the fluentd monitoring port (24220) via http.

## Contributing

1. Fork it
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create new Pull Request

## License

This application is distributed under the [Apache License, Version 2.0][4].

[1]: https://registry.hub.docker.com/u/ianblenke/fluentd
[2]: http://www.fluentd.org/
[3]: https://github.com/ianblenke/docker-logstash
[4]: http://www.apache.org/licenses/LICENSE-2.0
